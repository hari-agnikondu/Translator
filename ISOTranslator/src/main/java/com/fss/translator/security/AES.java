/**
 * The default package for all Encryption Classes
 */
package com.fss.translator.security;

import java.nio.charset.StandardCharsets;
import java.security.Key;

import javax.crypto.Cipher;
import javax.crypto.KeyGenerator;
import javax.crypto.SecretKey;
import javax.crypto.spec.SecretKeySpec;

import org.springframework.security.crypto.codec.Hex;

import com.fss.translator.exception.ServiceException;

import lombok.extern.log4j.Log4j2;



/**
 * A Simple class to perform AES 256 Encryption and Decryption functions using
 * an AES 256-bit Key
 * 
 * @author Vishy Iyer (viyer@incomm.com)
 * 
 */
@Log4j2
public class AES {

	/**
	 * The AES Algorithm
	 */
	private static final String ALGORITHM = "AES";

	/**
	 * The Key Strength in bits. For any key strength above 128-bits, ensure
	 * that the contents of the UnlimitedJCEPolicy.zip are extracted to the
	 * JRE/lib/security folder
	 */
	private static final int KEY_STRENGTH = 256;

	/**
	 * All the hexadecimal digits
	 */
	private static String digits = "0123456789ABCDEF";

	/**
	 * This function returns a Hex String representation of an encoded AES 256
	 * Bit Key
	 * 
	 * @return
	 * @throws APISecurityException
	 */
	public static String generateAESKey() throws ServiceException {

		String aesKey = null;

		try {
			KeyGenerator keyGen = KeyGenerator.getInstance(ALGORITHM);
			keyGen.init(KEY_STRENGTH); 
			SecretKey secretKey = keyGen.generateKey();

			aesKey = byteArrayToHexString(secretKey.getEncoded());

		} catch (Exception exp) {
			throw new ServiceException(exp);
		}

		return aesKey;

	}

	/**
	 * 
	 * @param plainText
	 * @param key
	 * @return
	 */
	public static String encrypt(String plainText, String keyString)
			throws ServiceException {

		String encryptedText = null;
		Key key = null;

		try {
							
			
			
			byte[] encodedKey = hexStringToByteArray(keyString);
			key = new SecretKeySpec(encodedKey, ALGORITHM);
 
			Cipher cipher = Cipher.getInstance(ALGORITHM);
			cipher.init(Cipher.ENCRYPT_MODE, key);
			
			byte[] ciphertext = cipher.doFinal(plainText.getBytes(StandardCharsets.UTF_8));

			encryptedText = new String(Hex.encode(ciphertext));
		} catch (Exception exp) {
			throw new ServiceException(exp);
		}

		return encryptedText;

	}

	/**
	 * 
	 * @param plainText
	 * @param key
	 * @return
	 */
	public static String decrypt(String encryptedText, String keyString)
			throws ServiceException {

		String plainText = null;
		Key key = null;

		try {

			byte[] encodedKey = hexStringToByteArray(keyString);
			key = new SecretKeySpec(encodedKey, ALGORITHM);

			Cipher chiper = Cipher.getInstance(ALGORITHM);
			chiper.init(Cipher.DECRYPT_MODE, key);
			byte[] encryptedBytes = hexStringToByteArray(encryptedText);
			byte[] decValue = chiper.doFinal(encryptedBytes);
			plainText = new String(decValue);

		} catch (Exception exp) {
			throw new ServiceException(exp);
		}

		return plainText;

	}

	/**
	 * Helper function to convert a hex string to a byte array
	 * 
	 * @param s
	 *            - The input Hex String to be converted to a byte array
	 * @return - The resultant byte array
	 */
	private static byte[] hexStringToByteArray(String s) {
		int len = s.length();
		byte[] data = new byte[len / 2];
		for (int i = 0; i < len; i += 2) {
			data[i / 2] = (byte) ((Character.digit(s.charAt(i), 16) << 4) + Character
					.digit(s.charAt(i + 1), 16));
		}
		return data;
	}

	/**
	 * Helper function to convert a byte array to a Hex String
	 * 
	 * @param ba
	 *            - The input byte array to be converted to a hex string
	 * @return - The resultant Hex String
	 */
	private static String byteArrayToHexString(byte[] ba) {
		StringBuilder sb = new StringBuilder();
		int off = 0;
		int len = ba.length;

		for (int i = off; i < off + len; i++) {
			int b = (int) ba[i];
			char c = digits.charAt((b >> 4) & 0xf);
			sb.append(c);
			c = digits.charAt(b & 0xf);
			sb.append((char) c);
		}
		return sb.toString();

	}



	/**
	 * The one and only main method
	 * plainTest and key we need to pass to encrypt the date
	 * Encrypted text and key need to pass to decrypt the data
	 * 
	 * @param args
	 */
	public static void main(String[] args) throws ServiceException {

		String fsapiKey = "E02CFF12E96C834AC216BA6F6187F26141C6A4DD024FA7047588009FD611C686";
		
		String plainText = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><xs:Document xmlns:xs=\"urn:iso:std:iso:20022:tech:xsd:pain.001.001.09\"><xs:CstmrCdtTrfInitn><xs:GrpHdr><xs:MsgId>920010201091407914071905</xs:MsgId><xs:CreDtTm>2019-07-03T18:12:01.475+05:30</xs:CreDtTm><xs:Authstn><xs:Prtry>1234567890ABCDEF</xs:Prtry></xs:Authstn><xs:NbOfTxs>1</xs:NbOfTxs><xs:InitgPty><xs:Nm>123</xs:Nm><xs:PstlAdr><xs:AdrTp><xs:Cd>ADDR</xs:Cd><xs:Prtry><xs:Id>123456789</xs:Id><xs:Issr>fss</xs:Issr><xs:SchmeNm>1234</xs:SchmeNm></xs:Prtry></xs:AdrTp><xs:SubDept>mumbai</xs:SubDept><xs:StrtNm>FPSCODE</xs:StrtNm><xs:BldgNb>FPSCODE</xs:BldgNb><xs:BldgNm>FPSCODE</xs:BldgNm><xs:Flr>Ground floor</xs:Flr><xs:PstBx>54321</xs:PstBx><xs:PstCd>34521</xs:PstCd><xs:CtrySubDvsn>south</xs:CtrySubDvsn><xs:Ctry>chennai</xs:Ctry></xs:PstlAdr><xs:Id><xs:OrgId><xs:Othr><xs:Id>FPSCODE</xs:Id><xs:SchmeNm><xs:Cd>FPSCODE</xs:Cd></xs:SchmeNm><xs:Issr>1</xs:Issr></xs:Othr></xs:OrgId><xs:PrvtId><xs:DtAndPlcOfBirth><xs:CtryOfBirth>chennai</xs:CtryOfBirth></xs:DtAndPlcOfBirth><xs:Othr><xs:SchmeNm><xs:Cd>FPSCODE</xs:Cd><xs:Prtry>chennai</xs:Prtry></xs:SchmeNm></xs:Othr></xs:PrvtId></xs:Id><xs:CtctDtls><xs:PhneNb>9400035489</xs:PhneNb></xs:CtctDtls></xs:InitgPty></xs:GrpHdr><xs:PmtInf><xs:Dbtr><xs:PstlAdr><xs:AdrLine>ORIGINATORADDRESS</xs:AdrLine></xs:PstlAdr></xs:Dbtr><xs:DbtrAcct><xs:Id><xs:IBAN>8888888888</xs:IBAN><xs:Othr><xs:Id>8888888888</xs:Id></xs:Othr></xs:Id><xs:Nm>ORIGINATORNAME</xs:Nm></xs:DbtrAcct><xs:DbtrAgt><xs:FinInstnId><xs:BICFI>11111111111</xs:BICFI><xs:ClrSysMmbId><xs:MmbId>33333333333</xs:MmbId></xs:ClrSysMmbId></xs:FinInstnId></xs:DbtrAgt><xs:DbtrAgtAcct><xs:Id><xs:Othr><xs:Id>48484848484848484848</xs:Id></xs:Othr></xs:Id></xs:DbtrAgtAcct><xs:CdtTrfTxInf><xs:PmtTpInf><xs:CtgyPurp><xs:Prtry></xs:Prtry></xs:CtgyPurp></xs:PmtTpInf><xs:Amt><xs:InstdAmt>100050</xs:InstdAmt><xs:EqvtAmt><xs:Amt Ccy=\"786\">200070</xs:Amt><xs:CcyOfTrf>786</xs:CcyOfTrf></xs:EqvtAmt></xs:Amt><xs:XchgRateInf><xs:XchgRate>100000000000</xs:XchgRate></xs:XchgRateInf><xs:CdtrAgt><xs:FinInstnId><xs:ClrSysMmbId><xs:MmbId>22222222222</xs:MmbId></xs:ClrSysMmbId></xs:FinInstnId></xs:CdtrAgt><xs:Cdtr><xs:PstlAdr><xs:AdrLine>BENIFICIARYADDRESS</xs:AdrLine></xs:PstlAdr></xs:Cdtr><xs:CdtrAcct><xs:Id><xs:Othr><xs:Id>9999999999</xs:Id></xs:Othr></xs:Id><xs:Tp><xs:Prtry></xs:Prtry></xs:Tp><xs:Ccy>826</xs:Ccy><xs:Nm>BENIFICIARYNAME</xs:Nm></xs:CdtrAcct><xs:Purp><xs:Cd></xs:Cd></xs:Purp><xs:RgltryRptg><xs:Dtls><xs:Inf>122REGULATORYREPORTING</xs:Inf></xs:Dtls></xs:RgltryRptg><xs:RmtInf><xs:Ustrd>121REMITTANCEINFORMATION</xs:Ustrd><xs:Strd><xs:RfrdDocInf><xs:LineDtls><xs:Desc>127RETURNEDPAYMENTFPID</xs:Desc></xs:LineDtls></xs:RfrdDocInf><xs:CdtrRefInf><xs:Ref>120REFERENCEINFO</xs:Ref></xs:CdtrRefInf></xs:Strd></xs:RmtInf></xs:CdtTrfTxInf></xs:PmtInf></xs:CstmrCdtTrfInitn></xs:Document>";

		String encryptedText = encrypt(plainText, fsapiKey);
		log.debug("Encrypted Text : [" + encryptedText + "]");

		String encryptedText1 = 	"6410652cc6bcb92cc6f6177d99a739be00d5f2a3442a3243c2ddcaf59792a9d15f3db7162927fe6563177626ee68f1fec45ef22c971a389ba6ccdd765d02ae8de578753e5ea0b6f5d80d000321559ae6465ad979fb9d3970b33de7cc714f0d252f983d424c7587bde369d62fba55a0cfea11a8ae4c30e84e82b872b4ba2a8d67e77233da6639161ffba07d78ebd3a5b8fe3fe787d5da7e4565df2f7bc0861ea05f7f41cd60d0bf444f8cc033036c8291aa7ded8c92c242b8ba0789cb35df0c9a875acc38d4e217be52f3dc6f8b777b5253a4054a1d344cc5838e49518eb554e389aad829ea0be78b0b989519fd42a13d13fdebb0af30cc1ee62fdbe0f10a8fde8e1b6fa1e251f4cfada249cf85f3c91977cb44a7b3eb107722ce43dd44511ebbfe3d9dd872b091e3b0c345ee017168cacc7d8e1e0a63446bcd818aa535aa9495468d3e994a87641636566dd00f32d246aff8833836a88821627228982d9b258f3a4ac764b041fdc1eb298b0ab73c4cd2736d15e6fdd8474a3901e8d2b2a966d7b8a7621bc42806eabb24d1dc524fd33ccd08bde95b57c6e74bd48c18a48899eff70573b7b845d9deb9b54267bb6ca7d2306ca3cbee8a1a8b808b985416da8756022d08572b4207ffe1b290caf9bb928135ac0f211ab001e10e8854fbd579786a7bc6d49f888433e4af52fe1384405c4cb8a7621bc42806eabb24d1dc524fd33c0c19f52e556d4c31581d579bd7afb53e5535caeffcb97a17a256a78d995574b8382a722c685b60f025b2a67f624ada8debf569027f368947103b893857dbd6febfbb0023afe69b570050922cd2d59080f9afce87fbe74797a4ad0f222cab3a54a5c9a1c31f30e7e70b3844a92e2553342e978209229b1aec698ac9cd455984bbf9f5d40d54c10d807de9db958ce37e88421a1382abf3c63ec7d36babd4e5f9df3d8a34e5bbfa7614e635b027eb9c5cfb5b469ca91c2169e5df8dda619bcf99c50528ea34a1309a7df3eacc74a0629b965ea40aab7174a66dad92c33ef70eb3701e4d88749f5f4dc42d3ffbbf7c4254edac2310d00fc42cc7d2ffc1c0679e26cd76c180ce50baa4d06ca22d7e1d8e12a2ba8bdd758b7263a8a8c64aa27ba0c1e52cb77e2955a484e07b8253a12eb0249dbd1e2ede7964710270dd053678769f4f9127cfdf562d262c03412a670fd1bce821c53f854c10d2c867199ad3a289e1675b5b300a2a6b694eefbe15585f959fc226e10197000006d8c809f68e8b3be4a40b1bdea94136aea6230b78e343e0d709f332c22b67fc92e9deff58b0f1b678e47029ab4b40879085daec963f2f174870da0adb170b47a8e301777a87f20ee2d9122ab85619760c70470f88dd6c65380f5a6669e211dd86b26cae21e69a26ee2f62865683ec2e4f3fa1cbe7030282dc99674f61129eea8b9235a4a8031498360d571d6f7bd027793709c37ddd798faaf9ef19b971fae8609bf08ab710f6ebac18fecdffc66d8167d7af631cc13ff10b90b7be98e58fbbfe570e9a963b0b365ab5b9730b9c3a1bfcadf6a2d23793ad7102f39a73d041ef0ed80757cfbdd793dcaea3e77e5deec4043ecb8f448825bf01c4db463de16d8fc773bb9ca68e69af4e5804ec3ed0e3bcf1ed1830925a629fb2ae4376c65655ac65e18bc7cb70c94026e4a7448d4fe39a7c2f9aa350313dcc7c5886e6038486d63f00f675cb9f0bc8ec460a9cb665d57d9dd85c037880b4c6f4518a5373fab80aedc2c00edbfd9ddd4aaa7018a0701d9931c95087e6012ce1e362c4e1b0ae9dd5a53a6314366eca334d25432c6c28d2251d7f9cd08a597217498f56dbdea50025ae151a5fee84cf8e4c7dc34c5c110276d5dfdbebce3c8911e4521522564fff765427933103a614f7be55a7503bce78a03e7316dfdd4f7f3c442d574a28912472a1ee66491ba1069b12e29267220d9726a1042d3ec46ac760e17b472b395c0b7730b89cddcf690973f6ef10a181e8401cbbc69a2bb41423c1996bbe4dbd90d1105698ecbe18074c26e83fddf8b9d7452b4b4dbfd7928c5e26212d1c403ac39be1bde2aeceae8dfa545b841bac7fad84b08b78fb189be0a380ac80adc9abc28df78034ef635d1e7ac4a6010c613d19e3a99431f3903ae47efc560aa2de41e9cd2ba5384d7b5f273c65234a92dd3edbe4564759722146b8d4d43584d3b80a3f2cd49468940e9740093b9a560b48ec5b29fc78bfe56ee1c02a0db55810436ace5f94aa692886f7592c7a7f50aeff06dccc520a276ef2b60e8460962218bb10f068b6cce56fae3ed8abdcde9c0e91d62a90c75da05e5ef3458827a95cc5aaf167773b0a04dab6387817703cbce916ae48bf950302447fe9cb2d7d0148bbe7d3dbe39ec7425deaab23a66e7efada65dd028710312e5bfba6c2f896fa0bb962bc46a54d1e454d2395cd2f28fa72af57931d42998832070ddf4f199ddca1b07ebd97bbb4c2bc704e7cc1a9c2b258ec10a2e3b9f91be68d8cc35bc0dcdaf0ecdf42274df5bae1fa5b547587c2dc354e1afcbfd8428ff00fe47acd768517cb86542d0b24e158b23124a40117594d5814c3897a3a17f8bb64daf21f27273c94420838768c6976c54e029632291c78fbbee1e097072435c2977526bda866139c45aff6d970ef477afa9cf736a648d73d34ee0176c69c7093acc101d2170a0d9daf20aa8870fd41bb9dd9e9d545a7fa75f2ce77632443dd0564dfaf94c87d0b011fef413e4f2f69933350e5161ae9d7f7c4f421a78ad723ee3247ed2c0955fb029605ec435d79e7a458bb234685d0127312787eaa83697ea255b577de4b0ccbc624da2b248d980b33579c2c4e5bf5c45fbc75dba1e79166fc70209ef5a7b99955a8a8a440add19d1c5605c535d8d9670cabe307e0016b8c686dd7d92a7ec2fd30e3d38c050f6fff81325bd01d875872826ca18832d482bededa8b228c0614f42ade5ebb69166438e8bee61c1d38ca19265db15b1ebc68147bcd45ae575e7b5f549580d6e6987dc301c689c96bca58a14dc3a75d754f9547254af0434964a548a314878a9b57c91fcc324d6e725b70feb3ae632112d1f91f64aa249d8be7d6858a5521d085985d9767da5c5516336e96caf91d43c2f8e4b51925627e14b72efdf874e247ec90a7af0326994bc5ff88407aac73052e284f9e0281d6f19f26cbb00555f019a88a49318fa24f2c031debced431d163787cc0cc69ef0777d1f2824fe83c899fcc066af53c2a7dc6ae25710c8201bfabafab9dcb9390eb40e60c82b43fb65aeb66f9565e023377a8c4122885297d2de4f04560024dc1e6bed9d4860181dcb8c7bda4468d4c1702a3fda2e1dfa31f33a6d3378dcbb86e4561188d29aad386fc2923c2d1df594d3e2cbe836b1685094bf390cd43b64e4822b9b35d7ae20edce149d9d6a6aaadcfbadbc294474532fdc1b184752beec9e5f657e6eb31becfd4e4c89bbec25239042224639ecc5be55faef9e30295a71a5e061b31c8bf1f800f1ee3151ae457173e9d4427096c76a84b25cb41fda51375b0e5678a9ecec5cd7a94c409be5ad6e1cae29a3a1fc2b91961ddf36e7bc6c5d5eb48637eb6a64175af30db735738baf56f49f8f95d516d4fb8b1b5b175f45e57f174e1bd80ac5a70c8de68c5e958e1e37ad1c7d7b8a0ca3a76dd6bc1b57940481527688ce1814f9f077cae5ca472ce9473bd4ce7fb67e1755ebfe3d83fdda092ba6fdb513ce0b62b6a710c175b3fd83b61b7b97a1c277209057642fb4be094d5ff41f047126d18c7d2737958a99fe0e437e41041f34052364e395c327f8809ad7a0639f2e4f581002050bd32853f024045688272e96d0d2e75242663a24bc33cae8750e260fba335102caba992fa977f58a270467d3d1a21829e45e2ca4b7654c3fefd91cfa773ad95d8928f5419f606185934792bb7814f56dbdea50025ae151a5fee84cf8e4c7dc34c5c110276d5dfdbebce3c8911e4523565b0d5cec5630dc12cc7296b9227329573cadf22f9b26c22de75059f443b010c8d210622c18fdebae17281d414a87141823b6274880540b9772dacf43639f1a082d89948259b64ad056449850f1e7658c9a004fd1bcc590493a08d9ecb82894c22b3076413786c838166d2651d093776c0a52596123fc6b8db89991cff9e63eba197c3b45aa03fe55d4ca730024b012ef0c17100e0a00c2576ca873a279f82191a9c6e7fb6899cd2362cd15d702f8a5dd3bc28f0f7c1619085654f7b2d811fca2fb7af43c88fd993870c4fd0b30d4c93f8ab9ea722503b7b77fe691a082e57d514251cbb8dd6de2604b1da42a0964b5c85e30b9b760d73a4e00c5ed7c3fd59472b395c0b7730b89cddcf690973f6efd20317da0d16258c1fe5c7b7f677df1fb833047e41c0cf91d14067cd459a3bfca7546c66231e07e574bb4bae6dcdb5eb0ba9543c555b5397562e5648fd45becdf2a96e3625ad5203a1152713c105f5acecc6d949d25874c935349b5ba0c5c24e1c52aef15e7312098d251de634ddd95816337b500ad95b37f581c1be891b986eff3ef49e3dd741f52f20d19785e6185f34ca5930448bafb871e972c565ba2dec7722ecb963c15bba94a1bfcd002a340ca2d8426440884b80a7608f19146385324978b4c0aff1d94ba3225df411db845d421244ad3cd02d2a4cc05564a3d7078d7a78060c153e025c0b479966ce54b3d38c5ed8a49171ed62cec7f18071a0ecce7d194403fb6d89556869a5a48b45d614324b82ee46b59489486099bd46b860c6611c5383f88ec1af65f756f532cae301b149cd308e9b5ff81ba115640c387bebe402dd3d15afabc515bfd658422e31fc47bbd6405c4dece2c10c8bd0158d54008cdd7bb3454ce574d34e0e862f6b3cbe8b6b3e4e87a3eed84d9fc4a702372578241005fde82935888cf6addad25efac6c87de450da7e95615b58781d5c4ddf979b4d590c573175133c53bba909f81d2edf666b89cde4b2b220f085129943b445b49e777a59c2cd40fb1090446e32a341c875fb592d455e43d43732ad350632acbe4dbd90d1105698ecbe18074c26e83fddf8b9d7452b4b4dbfd7928c5e26212d1c403ac39be1bde2aeceae8dfa545b841bac7fad84b08b78fb189be0a380ac80adc9abc28df78034ef635d1e7ac4a6010c613d19e3a99431f3903ae47efc560aa2de41e9cd2ba5384d7b5f273c65234a92dd3edbe4564759722146b8d4d43584d3b80a3f2cd49468940e9740093b9a560b48ec5b29fc78bfe56ee1c02a0db55810436ace5f94aa692886f7592c7a7f50aeff06dccc520a276ef2b60e8460962218bb10f068b6cce56fae3ed8abdcde9c0e91d62a90c75da05e5ef3458827a95cc5aaf167773b0a04dab6387817703cbce916ae48bf950302447fe9cb2d7d0148bbe7d3dbe39ec7425deaab23a66e7efada65dd028710312e5bfba6c2f896fa0bb962bc46a54d1e454d2395cd2f28fa72af57931d42998832070ddf4f199ddca1b07ebd97bbb4c2bc704e7cc1a9c2b258ec10a2e3b9f91be68d8cc35bc0dcdaf0ecdf42274df5bae1fa5b547587c2dc354e1afcbfd8428ff00fe47acd768517cb86542d0b24e158b23124a40117594d5814c3897a3a17f8bb64daf21f27273c94420838768c6976c54e029632291c78fbbee1e097072435c2977526bda866139ccb0ba88f1814c9de2b024724635479c01ecbb79b3c6e780814916c31d4e8b12fb68a4965f1bc3d852c6b86956f53701e0cbd288260ba4e43dd97b55115e3db8a4465bd4d589e3e53fe5aa60ebc0113224cff4ced6c54520889df686b1d7dde4a10a181e8401cbbc69a2bb41423c1996b30e0dd65dd6aef946a06b3c5aa2d98068e7c12a2428061a575062f9b52fa34a38a1061c24b9cdfe3a534a545e3e1db0b7a404ebff97e04f8541879eb50eceeb7da2ff76f4a20129d20d76e9d8c5f81c3ab519b9045d1281761b33ed38e7d933a5224fa48a522eeda6d9711fc9b105908049f3b277b0c1c386522e7565ea3e16ec4b860c9b73a7479e7ddd97192f14f89f96524bbc64d303943b7cf6609f2b7acd1acc73fe3cc8134af5f77ecce6e74ca4c85930d6da46b45ffeec8b9c5771406fec0b11d1e3f23261c8605216cdb24aa23dbfbf3277fc9478bbcf3345565ed527c0e302c0e65d1b6ec97b43a1189470cd6f683676a7f0c1dabcc4f2b16e461e6bb3f9f686abee50edf0ab2315ec6e72909e98fee4cfaee8d1d3ca5894459fe73c9a9e4963ce795a3cdab3da3cb6e0e604c503264e19a84cd99b8c265e56290316756de91fc8fe419cd5a2bdeda703847a57f139d44a35fcb7e4b39c1d19909f9a10abb9a804911a75e4c2243f085efb19670c56b7f179fc2095b3feb9f516beeb22211c8fc55993b53a6063cc3973a50e0c97a9e775f3fb6029a557f55f13b2206a3d7bf113fd6e4cc37c4753675b5cf5ed3ce8fb3233a453e9993b8322332f0f2736f87f7246ef22c7bafa81f37ab9e39d832fb124c27b53a434b87244f0c144a7ee929f33ccf3b7c73493a87c242402f93d35944dfa552c4a49d070518e2eccbdd786792f4249ac862e7ac15337b8fc9db193c13be2869f23686fb0ec67de669089a86fa7da049d1d0ea65e86b1728601b70bfb6d0b6a303272003c01cee2ef31ce399e6c85f7c46ec011561e09b172bc0133f894443a5a90afd1521ba6191d97d9e51dd1120d913931e56cb4bcfcaf6a43dda0bdd15d78b91fc2ae0961d853d3175a5ade1dff352c9a7d64cf8d8a995cdf0ce0f2e75d2a25b4ccdabe5f71e28392d7ee11503213701bfd9cce86cc8bd16a6fa63fdd0e58687794691a4d3160f2ef25a08611ff0d4d01f29d110e00868c36b3bdd0cdca87a713ca86f704e01d56f457e8c0c0a738dcc93f03c23001bdc4c593f93c57518a49af4b401d577707ac41669f8b22e3fc2e1bb4f7ec776f5d3c16fdde5f55f76f1bcf0e3517de62e8718d5e94dcd95ee85f8b6e2ed82643e6daa5a3f6020fc7e59a1f141960440cb9b50727e6f8ba10c5c358a5ece2795f1b0f1f2af3699e021373a40afed23bcb99dbb417e7a906ec77a2e3c2a11a9ede04ffbba481470882dbd83735c4d889ca298172046a36fd92c840f42374e2c99df55e8669c81e919f099f3bba3b8e1c9602d39ffac1d9ec6d36a2a00df2190ca8ad635e0a7538d84f725e290570da0f97646de2d1d227bf6f410c05be773357925bb1c02ca79e84d79c287c239999efdda49299a683db9867996d78a9027acd6baed80fd13e5a7345cf5d55aaea52ca20cde01699812df095f4fcd1cfa5ad9cc26140dd5ceb30982d35e8a69df851f502cf75cf3ca8ca26d2aa97018ec26c72b14770cf6d175c4897067897dcce28384c8d91bcb5ed1c5afe83db64686637674da9ead6235e8f6423058e7c9d4dff6b9aa811a9a1e0e9787e7f24dd518878fd4deca766e2807faff9966c04def6708b5add4ddd7031bf6b5bc5d4dc37cadd576d9d398dc31539fe6e8529c8b8370e1c3c254dea14ff3e168e0b4a720860c0d677dd7b557db8d19c5f592258e89d7e16f68fe01fe68b4ea6ae7892f3ddbfeaf5ddfc2f5a571d399c87b8ce7a236c9a89f620d88870cf5347f21d7788dd71be9c094660494276b0034794bdf3b5875fcbf4d1c81e36cbf26157ec28d2fc1e8e09e6be6a8f26e9432bff7b45af967b7989dbb25c6aa9eb2617c3481311bfda4b9127723e0479ab366149470f6c51d03878907a7c7ecd22d81a8ad717e2b0014d7a01c04c96f4051132b924f8c0394155ef32e15b1c45038d402c2ef0d6906f6260048a51342433eb9cc97d602bedc778bc04ab7206a2afbef3ade742448fb7ba602e52a3e0b58fff74e5236f2bb4511dd113e9514602a7f6a30d42a6ea07ba5a6b51e490c6ae7296a7b480c893c6d14b60ebcfab1d721aa79f8002b5a3b2465df04748c6f061e676d0f0bec43da3c3c4ca849703c7900aeed541bcd965391b0a5aa6f39624c72d225266019ea5d061289b3cc6bd449c5f49efd61546eb924de7158e4f6e9f28205173709059fe48c19ece8092fcab8b9b66b3a4be9a767aaafc314fce4deb4c08a37af08dfbc53b5120b30eee511a087b90e6fc66fb6036c66c3e451d209ed48be92c3529a46cb4a884e03c572260eca77d0877dc0b2db1535ccf65d12e1d08a29f740c116e9ccaaffb1962b741ae54766028543fe58ae51fabc5b6a26b24623332a9d8a09b0288e3ba8a0aca3b729620896ca0fc4fdc5228efd541ab75a34cfe56c6a912c0d29aec1f91d2119f8e21d4d5ec890fb500af50553a31ba7393f77746cd1dc5d2beec5710e4f1d0da581f713dcfc89e9d66280c1828cb117fa4fe2f77725ee3753f960efc2c287b253ed1a0b3fca025d6a1ce4f5da3fd679d2927f9e93317518c8304a43b3b67c57609fb5d48933aaa2437d0e0c4a459f584f0fae7461ba24004dc3df85bea946fc691c1474083039ac1260d4882dafe59dbb417e7a906ec77a2e3c2a11a9ede04ffbba481470882dbd83735c4d889ca298172046a36fd92c840f42374e2c99df55e8669c81e919f099f3bba3b8e1c9602d39ffac1d9ec6d36a2a00df2190ca8ad635e0a7538d84f725e290570da0f976a6103c24e14edd8cdb42f3c2ed96d06be912e92fc162a949c8c834aa88801c83513fe477c35cdd7f47882a475b17472d54677ffb3002c3641937f9c5bd7d4ebeb2dba7e04342eb7a995db42b3614b2ec8a115fcb8199f802a9f6bc17940793fcfe7c22acffd8cbfe959e13f2cbbb1cd78ae10c060a9f600a37eeba151b8605d659d5897f4fcf51259c67ecadc4bf550731396b92b1f3eb6a6e15720830466ef61216225befaaa6af923c05833ba7656b04cd0449c5cbda309c03d4d21ee5da89994c966853c32fbe2f063c4c847a187ccfa8d8425003d4de13cd52604db6fec06413a790b823d54063dd4d049e4e1d0d2fa435d6f71c16ac8401f4884ed17cc9e94005cb4653b0cf5017093ffb9feb2755e5c1839e28af7cea6334efb01c5f04267d9a910886a1c7b40a3610f1b7d383ff02bb0085bbbbf2a5ab5f716881276fdca54bbf4e0b30adef9865a105fd63bbc9845d7096f895efa665a6f727ef25e86062923ce3dc2dd53dc916b64b0a4de358c056b073539149fe466d438cdf6fc5a06b4bc8872f141a938ca2b0ce9e9ab8c4b888d404ba3d25c777e70e07cb96cf6c213c2d8c6bfb66e59b05c0e4cf46738a914713c36e3e037787964d4950bbe09abc4af614158a65f6bbc3c5b851745437a8706d1dba7d9f67c190daecd846d34d5b558b2119d2f317102f8ec41eaecb00278230e1ccbe2a70789d51f658058b1a24167f5ef4972f5cbba244331609faea3aebc42cc330081483d861ba2bf32ec37016ffc5e72a4154e28fb1801ea47404b353e9b0555c8037ea4f42961921c6730b405496ccd14ba828eca948ffb8acf6bda8dbf12e31902cd480b00afb3c9275242663a24bc33cae8750e260fba335d4affbf9b118f01e9bc3ca6904cdfef512fb0588d0ebbdb2590914fb2a5a32a3eed0b5156fe60e26c9aef33ae2bbb28133d9d15c30b06a488d3b640146ece4bfa79fd49fb4cb303bbe24ac57aaff2e6356647d561cc937e3b2bb1d5fdc34ea900a2189031cd6b7b22d5cfb84353dbb46dfc5fe5876c0f1079502b218fa64d6b4130ec4413e808aba51eafc20ad774bbd2f4c8f94f1b5829c6b562498a19f1e543f0a574119d9ef396be4688c469ff2a3c6e9ed8243feb94fc0e0ab22886ab9eb932ba3f1c3e25f93f55dffe135092bda3100db8931386ecfc961df48fda3d609fb1885e443c97a1a1b24d02f345be7519563eec4c4de8685927dee92d068013974462d7e395669414420f3206de50212f65b1ab91f37e645d0ad99b170138cd03170a4e0251c394b5e2b6ec59b59a3c045125fe3b8bf28ffbea0fbd1cb3dd6dfc4f421a78ad723ee3247ed2c0955fb0238888df1d2627f6a57f001ac9487b51e332c8d1b9a2b13e574740b4f22a78baac93fd91cb01812751512c485434e4df41e1b13b97418d46a7057fc6774887d9f1a96c4b8326f673830289243ed7464033dd18fedfa7c5f9b546acf890c1500c4e09515b4ee749fb449d860b36d57fa3ea8965f0942e1c12a16fbbe5abd0909d25ea40aab7174a66dad92c33ef70eb3701e4d88749f5f4dc42d3ffbbf7c4254edac2310d00fc42cc7d2ffc1c0679e26cd76c180ce50baa4d06ca22d7e1d8e12a2ba8bdd758b7263a8a8c64aa27ba0c1e52cb77e2955a484e07b8253a12eb0249dbd1e2ede7964710270dd053678769f4f9127cfdf562d262c03412a670fd1bce821c53f854c10d2c867199ad3a289e1675b5b300a2a6b694eefbe15585f959fc226e10197000006d8c809f68e8b3be4a40b1bdea94136aea6230b78e343e0d709f332c22b67fc92e9deff58b0f1b678e47029ab4b40879085daec963f2f174870da0adb170b47a8e301777a87f20ee2d9122ab85619760c70470f88dd6c65380f5a6669e211dd86b26cae21e69a26ee2f62865683ec2e4f3fa1cbe7030282dc99674f61129eea8b9235a4a8031498360d571d6f7bd027793709c37ddd798faaf9ef19b971fae8609bf08ab710f6ebac18fecdffc66d8167d7af631cc13ff10b90b7be98e58fbbfe570e9a963b0b365ab5b9730b9c3a1bfcadf6a2d23793ad7102f39a73d041ef0ed80757cfbdd793dcaea3e77e5deec4043ecb8f448825bf01c4db463de16d8fc773bb9ca68e69af4e5804ec3ed0e3bcf1ed1830925a629fb2ae4376c65655ac65e18bc7cb70c94026e4a7448d4fe39a7c2f9aa350313dcc7c5886e6038486d63f00f675cb9f0bc8ec460a9cb665d57d9dd85c037880b4c6f4518a5373fab80aedc2c00edbfd9ddd4aaa7018a0701d9931c95087e6012ce1e362c4e1b0ae9dd5a53a6314366eca334d25432c6c28d2251d7f9cd08a597217498f56dbdea50025ae151a5fee84cf8e4c7dc34c5c110276d5dfdbebce3c8911e4521522564fff765427933103a614f7be55a7503bce78a03e7316dfdd4f7f3c442d574a28912472a1ee66491ba1069b12e29267220d9726a1042d3ec46ac760e17b472b395c0b7730b89cddcf690973f6ef10a181e8401cbbc69a2bb41423c1996bbe4dbd90d1105698ecbe18074c26e83fddf8b9d7452b4b4dbfd7928c5e26212d1c403ac39be1bde2aeceae8dfa545b841bac7fad84b08b78fb189be0a380ac80adc9abc28df78034ef635d1e7ac4a6010c613d19e3a99431f3903ae47efc560aa2de41e9cd2ba5384d7b5f273c65234a92dd3edbe4564759722146b8d4d43584d3b80a3f2cd49468940e9740093b9a560b48ec5b29fc78bfe56ee1c02a0db55810436ace5f94aa692886f7592c7a7f50aeff06dccc520a276ef2b60e8460962218bb10f068b6cce56fae3ed8abdcde9c0e91d62a90c75da05e5ef3458827a95cc5aaf167773b0a04dab6387817703cbce916ae48bf950302447fe9cb2d7d0148bbe7d3dbe39ec7425deaab23a66e7efada65dd028710312e5bfba6c2f896fa0bb962bc46a54d1e454d2395cd2f28fa72af57931d42998832070ddf4f199ddca1b07ebd97bbb4c2bc704e7cc1a9c2b258ec10a2e3b9f91be68d8cc35bc0dcdaf0ecdf42274df5bae1fa5b547587c2dc354e1afcbfd8428ff00fe47acd768517cb86542d0b24e158b23124a40117594d5814c3897a3a17f8bb64daf21f27273c94420838768c6976c54e029632291c78fbbee1e097072435c2977526bda866139c45aff6d970ef477afa9cf736a648d73d34ee0176c69c7093acc101d2170a0d9daf20aa8870fd41bb9dd9e9d545a7fa759d8c9a30e0224b0930357d393b2306a09bd56720475fd58977dd80315cbbc3de68bc5cf81a2553c3824793a47b75fa148523cc701db46e37fe21644cb3164505811a9a1e0e9787e7f24dd518878fd4de587012053c941d85f917318c5c5a95dd8f4f710e1662378a65c4fbfb6f0e7d2ef70573b7b845d9deb9b54267bb6ca7d299dc28d010e9856c6ffaf9fa922d21b627cccf5e6e884407bf316bca04ac1dcc5346cc307d95fa318e00f26ef24635430647b37f583185ec821a291f5d3c47661e7424343216baf90ae53fd43c9ba88b1216225befaaa6af923c05833ba7656be4355864c1f5f6a1c9893aab276c1a514ff764ecba3c7d2253f1909c197cb24ef75cf3ca8ca26d2aa97018ec26c72b14770cf6d175c4897067897dcce28384c8d91bcb5ed1c5afe83db64686637674da9ead6235e8f6423058e7c9d4dff6b9aa811a9a1e0e9787e7f24dd518878fd4de707ef939c260bfc1b77340cda5a833ff454e1f0c42c4f0420030841c5adb2c9321125e0ad5750a53ec6ce161fb463b1615b1c45038d402c2ef0d6906f6260048a51342433eb9cc97d602bedc778bc04ab7206a2afbef3ade742448fb7ba602e52a3e0b58fff74e5236f2bb4511dd113e9514602a7f6a30d42a6ea07ba5a6b51e490c6ae7296a7b480c893c6d14b60ebcfab1d721aa79f8002b5a3b2465df04748c6f061e676d0f0bec43da3c3c4ca849703c7900aeed541bcd965391b0a5aa6f39624c72d225266019ea5d061289b3cc6bd449c5f49efd61546eb924de7158e4f6e9f28205173709059fe48c19ece8092fcab8b9b66b3a4be9a767aaafc314fce4deb4c08a37af08dfbc53b5120b30eee511a087b90e6fc66fb6036c66c3e451d209ed48be92c3529a46cb4a884e03c572260eca77d0877dc0b2db1535ccf65d12e1d08a29f740c116e9ccaaffb1962b741ae54766028543fe58ae51fabc5b6a26b24623332a9d8a09b0288e3ba8a0aca3b729620896ca0fc4fdc5228efd541ab75a34cfe56c6a912c0d29aec1f91d2119f8e21d4d5ec890fb500af50553a31ba7393f77746cd1dc5d2beec5710e4f1d0da581f713dcfc89e9d66280c1828cb117fa4fe2f77725ee3753f960efc2c287b253ed1a0b3fca025d6a1ce4f5da3fd6231faeb68e2a4d75b77c80bc686dd5b272667a457f620ce2ef4e91fe64e846a34879569968699a8dd4381edc333d2b63e8457ce3d9010e52a49b2158247100773aac0e114a8caa1082765cfa78e1c48ac9b9f2ffac9ea328ae0817660c00383d71a399f044bfaae5b35b147bcf7a36698fbac1601018d0f4cc2108495bc3abca472b395c0b7730b89cddcf690973f6eff91bd939c00c51b284128620ba3958e21e7424343216baf90ae53fd43c9ba88b1216225befaaa6af923c05833ba7656b5d94e51bba5dc39b1bcd4f985fa8f83778e9bae492709d42576c3e97761255dac91c581575b32e75c4e655f3b4457ddbb11b9d5dbe84a16e33b520cb022e6365888b5c0b08c9c2ae2e48fcf97b2a4d43e4ad713ad4f1959688676fce64f591c0a114521f1103d4a18586fe29fb12e9a32a321e734eb36c5ccff07ae7034e9b4a5a12fa3eb0beea9919230ca8ad1ee1b2762be4f3d944654e2267e27ba46a5a03b9f7f64ba061f97c6eb02ea70d4ca829553f15183ae440469b84df3270ddc1c59547aca4884cdb02b49bc17f4854a99e9d0e2342e4cfed7e8c10bf3a2ae28fdb1903ab29ede140eb924f61f507b2ebd575242663a24bc33cae8750e260fba3353f979fab59ff956d7ff2f7b8447814381d33464803d6c36970512e09676b6cc41a96c4b8326f673830289243ed7464030f17adeab212b9052d1e265a5f240d0f56910b0732d10570013f6d3207dc75374c7f5c3b0d1543e978ed4516057bcfba9f465c27ee4f9a55a6cc5681f2af3e35154425e47c81c2e6643076c8dcb560b29dd4a535934cf7b37a354077742bce4a0579f9be09f5f35984ea3417a0a4f51aa3d814a70f8ae9837a27817e869736939f09939cbc279cd4e1e22ca2bf72c54c4521857de0759a28bfd2b939b025057aeed1ad7c9668a4fdcb27b20fc95e3ff77da0a1a4e81860fb929fe75bf99545dfbf5e174877c2e1d239c3b496aa37f658fdeb2bb65506c1ba12f153b0acdefb4b46aebaef7e7e363609a73d5c9d4351121e5436a6fc842f61c20ae54f6de764d3bce9885c94a614ffa1559cdf17ef3600ab3e749f64ee12a6575e4f622e7a6802976d13148a88e8f29f0f2576500bab1734e5f6ab535506c964d31056cff850ea59b79c4a61ffb235e29fc2a362314b423a83381baa7d3ab0dc1b0e059162eff21a3a4c3f45a41a31b922c59f9867b1743ae56b9307fd72cfe20ab43a3e37e133f08db4b324331e014a1761a495296df4a06de2e13e888942373b0e0ea1c1e26d136bd3edee76197b33d408e0275af6f738898ee82ea1cf7a76bcd08b282d08da261e0149b820e0a4d541b627431dade45bbad935b2659dba02130bbbf4680a1154781f99ef60224e8c26265d223ced67bb1c02ca79e84d79c287c239999efdda49299a683db9867996d78a9027acd6ba853e806c9eda085a46f902ecfc14162e2dff9754ba863c6a08fac8fb7abfc0800285491b26d70dc78df519214c3036f2727a24541a03bcf0507b6c8b641b4bff4917183ab8e8d6ef7e848a6749a4e17dded2ac50fb44759c8dcabcd0a496305bcb561ac0c200a7e1cd6a8b50dadbd21dda67294480c6bd49bd957633ec963c0f79efd67cd257aadee2efe151c176f7a2e61c2cec9a1f0b9461b40dcf4925b82ec20a5858343496d358d643053ea43ec61a96c4b8326f673830289243ed746403e46dd2db1b4b49787a5145b6dd426bf4e12ba41ee45078ef0739b6ea9226aaa449c611939923a928168333ecd2c6b3cc3d6b7ec296bd106c55a62f6c08f3c7d88a1061c24b9cdfe3a534a545e3e1db0b7705deb33757f011ffab84fe9e39e306d720f9479b6b66e224273cec9dc2afe8c3a491c630634397d56d950d447c125b9ff2ad3728296f726ee60ac85d35deb056182956b68afefe725ac316b032b494c83e47912f9e1c0cf57d7318190f607cbf41008d3d5a2ad11fbf7453cd2afa1d37c50b35dffeca8945f515ce4cecf041a92a48b4d003ecb1691562d7f89de25a4d77fc78946db9e10f0a6315c4f65c38e496a0ede345705c6fb65994e80a6baa44b787043e045b8496f26b72fae0ada64aa97b693e3272b5f3096834caa1db0619b3e60eedc80a3c5883b1702b5187f447daace02cfe7d67137b3a9bf7b8c4c2da90f6445cac5e8ca5f20c8b911cfa9daf7a535f6892189138ef1963927d64a1c4258ab6c38410c7bb74a18e84e411d9ace75a0dffd913e45792016c6560701437a07cdd27a66775aaee9f9ab50e9a3a393fe76beff031d9bafade35c0ab92cd01caacb5a3d209e7a0221f9f10c49e7d";

		String test = decrypt(encryptedText1, fsapiKey);

		log.debug("Decrypt text:"+test);
		
	}

}
